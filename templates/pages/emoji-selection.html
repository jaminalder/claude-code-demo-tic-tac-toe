{{define "emoji-selection.html"}}{{template "base.html" .}}{{end}}

{{define "content"}}
<div class="hero">
    <h2>{{.Title}}</h2>
    
    {{if .IsWaitingState}}
        <!-- Player 1 waiting for opponent -->
        <div class="waiting-state">
            <div class="waiting-message">
                <p>You selected {{.SelectedEmoji}}!</p>
                <p>Waiting for opponent to join...</p>
            </div>
            
            <div class="game-sharing">
                <p><strong>Share this game:</strong></p>
                <input type="text" class="url-input" value="{{.GameURL}}" readonly onclick="this.select()">
                <button onclick="navigator.clipboard.writeText('{{.GameURL}}')" class="btn btn-secondary btn-small">Copy Link</button>
            </div>
            
            <!-- SSE Connection for game ready event -->
            <div hx-ext="sse" sse-connect="/api/game/{{.GameID}}/events" style="display: none;">
                <div sse-swap="game_ready"></div>
            </div>
        </div>
    {{else}}
        <!-- Player selection state -->
        <div class="instructions">
            {{if .IsFirstPlayer}}
                <p>Choose your emoji to represent you in the game!</p>
            {{else}}
                <p>Choose your emoji to represent you in the game!</p>
                <p>Grayed out emojis are already taken by other players.</p>
            {{end}}
        </div>
        
        <form method="POST" action="/game/{{.GameID}}/select-emoji" class="selection-form">
            <div class="emoji-grid">
                {{range .AvailableEmojis}}
                    {{if .available}}
                        <button type="submit" name="emoji" value="{{.emoji}}" class="emoji-option">
                            {{.emoji}}
                        </button>
                    {{else}}
                        <button type="button" class="emoji-option" disabled>
                            {{.emoji}}
                        </button>
                    {{end}}
                {{end}}
            </div>
        </form>
    {{end}}
</div>
{{end}}

